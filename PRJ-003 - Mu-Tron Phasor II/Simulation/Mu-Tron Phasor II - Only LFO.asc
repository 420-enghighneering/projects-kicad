Version 4
SHEET 1 4624 1972
WIRE 1696 656 1648 656
WIRE 1824 656 1760 656
WIRE 736 672 688 672
WIRE 960 672 736 672
WIRE 976 672 960 672
WIRE 1184 672 1152 672
WIRE 1264 672 1184 672
WIRE 960 688 960 672
WIRE 576 752 144 752
WIRE 736 784 736 672
WIRE 960 784 960 768
WIRE 1104 784 1104 736
WIRE 1104 784 960 784
WIRE 1184 784 1184 672
WIRE 1264 784 1264 672
WIRE 144 800 144 752
WIRE 480 816 464 816
WIRE 576 816 576 752
WIRE 576 816 544 816
WIRE 592 816 576 816
WIRE 672 816 656 816
WIRE 1504 816 1472 816
WIRE 1648 816 1648 656
WIRE 1648 816 1584 816
WIRE 1696 816 1648 816
WIRE 2192 816 2160 816
WIRE 2304 816 2256 816
WIRE 1824 832 1824 656
WIRE 1824 832 1760 832
WIRE 1888 832 1824 832
WIRE 1952 832 1888 832
WIRE 1696 848 1648 848
WIRE 1952 880 1952 832
WIRE 144 896 144 880
WIRE 416 896 144 896
WIRE 464 896 464 816
WIRE 464 896 448 896
WIRE 672 896 672 816
WIRE 688 896 688 672
WIRE 688 896 672 896
WIRE 736 896 736 848
WIRE 960 896 960 848
WIRE 960 896 736 896
WIRE 1184 896 1184 848
WIRE 1184 896 960 896
WIRE 1264 896 1264 848
WIRE 1264 896 1184 896
WIRE 1312 896 1264 896
WIRE 416 912 416 896
WIRE 1312 912 1312 896
WIRE 1472 912 1472 816
WIRE 736 944 736 896
WIRE 960 944 960 896
WIRE 2640 944 2608 944
WIRE 2672 944 2640 944
WIRE 464 976 464 896
WIRE 480 976 464 976
WIRE 576 976 544 976
WIRE 592 976 576 976
WIRE 672 976 672 896
WIRE 672 976 656 976
WIRE 2224 976 2224 960
WIRE 1648 992 1648 848
WIRE 1680 992 1648 992
WIRE 1824 992 1824 832
WIRE 1824 992 1760 992
WIRE 1952 992 1952 960
WIRE 2016 992 1952 992
WIRE 2160 992 2160 816
WIRE 2160 992 2096 992
WIRE 2192 992 2160 992
WIRE 2304 1008 2304 816
WIRE 2304 1008 2256 1008
WIRE 2368 1008 2304 1008
WIRE 2416 1008 2368 1008
WIRE 960 1024 960 1008
WIRE 1104 1024 960 1024
WIRE 2192 1024 2160 1024
WIRE 144 1040 144 976
WIRE 576 1040 576 976
WIRE 576 1040 144 1040
WIRE 1184 1040 1184 896
WIRE 1264 1040 1264 896
WIRE 1952 1040 1952 992
WIRE 1104 1056 1104 1024
WIRE 2416 1072 2416 1008
WIRE 2640 1072 2640 944
WIRE 3424 1072 3376 1072
WIRE 3536 1072 3488 1072
WIRE 3648 1072 3600 1072
WIRE 3744 1072 3712 1072
WIRE 448 1120 448 896
WIRE 736 1120 736 1008
WIRE 736 1120 448 1120
WIRE 960 1120 960 1104
WIRE 960 1120 736 1120
WIRE 976 1120 960 1120
WIRE 1184 1120 1184 1104
WIRE 1184 1120 1152 1120
WIRE 1264 1120 1264 1104
WIRE 1264 1120 1184 1120
WIRE 2896 1120 2896 992
WIRE 2864 1136 2816 1136
WIRE 3040 1152 2928 1152
WIRE 3088 1152 3040 1152
WIRE 1648 1168 1648 992
WIRE 1952 1168 1952 1120
WIRE 2160 1168 2160 1024
WIRE 2416 1168 2416 1152
WIRE 2496 1168 2416 1168
WIRE 2640 1168 2640 1152
WIRE 2640 1168 2576 1168
WIRE 2864 1168 2640 1168
WIRE 2416 1184 2416 1168
WIRE 2640 1184 2640 1168
WIRE 3328 1200 3152 1200
WIRE 3424 1200 3328 1200
WIRE 3536 1200 3488 1200
WIRE 3648 1200 3600 1200
WIRE 3744 1200 3744 1072
WIRE 3744 1200 3712 1200
WIRE 1648 1296 1648 1248
WIRE 2304 1296 2304 1008
WIRE 2304 1296 1648 1296
WIRE 2416 1312 2416 1264
WIRE 2816 1312 2816 1136
WIRE 2864 1312 2816 1312
WIRE 3248 1312 2944 1312
WIRE 3440 1312 3248 1312
WIRE 3744 1312 3744 1200
WIRE 3744 1312 3440 1312
WIRE 2816 1424 2816 1312
WIRE 2864 1424 2816 1424
WIRE 2960 1424 2944 1424
WIRE 3040 1424 3024 1424
WIRE 3152 1424 3120 1424
WIRE 3248 1424 3248 1312
WIRE 3248 1424 3232 1424
WIRE 3264 1424 3248 1424
WIRE 3440 1424 3440 1312
WIRE 3440 1424 3344 1424
WIRE 2816 1536 2816 1424
WIRE 2864 1536 2816 1536
WIRE 3040 1536 3040 1424
WIRE 3040 1536 2944 1536
WIRE 3040 1568 3040 1536
FLAG 416 912 0
FLAG 1312 912 0
FLAG 1264 1120 Vneg
FLAG 1264 672 Vpos
FLAG 1472 912 0
FLAG 1952 1248 0
FLAG 2160 1248 0
FLAG 1728 736 Vpos
FLAG 2224 896 Vpos
FLAG 1728 864 Vneg
FLAG 2224 1040 Vneg
FLAG 2416 1392 0
FLAG 2640 1264 0
FLAG 2752 944 0
FLAG 2528 944 Vpos
FLAG 2896 992 Vpos
FLAG 3152 1104 Vpos
FLAG 2896 1184 Vneg
FLAG 3040 1568 0
FLAG 1888 832 OP1OUT
FLAG 2368 1008 OP2OUT
FLAG 3040 1152 OP3OUT
FLAG 3328 1200 VDIODEPOS
FLAG 3744 1200 VDIODENEG
SYMBOL cap 720 784 R0
SYMATTR InstName C16
SYMATTR Value 470µ
SYMBOL cap 720 944 R0
SYMATTR InstName C17
SYMATTR Value 470µ
SYMBOL zener 976 848 R180
WINDOW 0 24 64 Left 2
WINDOW 3 -140 6 Left 2
SYMATTR InstName D1
SYMATTR Value MMBZ12VAL
SYMATTR Description Diode
SYMATTR Type diode
SYMBOL res 944 672 R0
WINDOW 0 -55 18 Left 2
WINDOW 3 -61 58 Left 2
SYMATTR InstName R38
SYMATTR Value 1.8k
SYMBOL zener 976 1008 R180
WINDOW 0 24 64 Left 2
WINDOW 3 -140 3 Left 2
SYMATTR InstName D2
SYMATTR Value MMBZ12VAL
SYMATTR Description Diode
SYMATTR Type diode
SYMBOL res 944 1008 R0
WINDOW 0 -55 47 Left 2
WINDOW 3 -59 85 Left 2
SYMATTR InstName R39
SYMATTR Value 1.8k
SYMBOL voltage 144 784 R0
WINDOW 0 37 53 Left 2
WINDOW 3 -173 -9 Left 2
WINDOW 123 0 0 Left 0
WINDOW 39 -173 16 Left 2
SYMATTR InstName V2
SYMATTR Value SINE(0 15 60)
SYMATTR SpiceLine Rser=0.1m
SYMBOL diode 480 832 R270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName D3
SYMATTR Value 1N4148
SYMBOL diode 592 832 R270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName D4
SYMATTR Value 1N4148
SYMBOL diode 480 992 R270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName D5
SYMATTR Value 1N4148
SYMBOL diode 592 992 R270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName D6
SYMATTR Value 1N4148
SYMBOL npn 1056 736 R270
SYMATTR InstName Q1
SYMATTR Value 2N3904
SYMBOL cap 1168 784 R0
SYMATTR InstName C18
SYMATTR Value 47µ
SYMBOL cap 1248 784 R0
SYMATTR InstName C19
SYMATTR Value .01µ
SYMBOL cap 1168 1040 R0
SYMATTR InstName C20
SYMATTR Value 47µ
SYMBOL cap 1248 1040 R0
SYMATTR InstName C21
SYMATTR Value .01µ
SYMBOL pnp 1056 1056 M90
SYMATTR InstName Q2
SYMBOL res 1072 1104 R90
WINDOW 0 85 52 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R40
SYMATTR Value 100R
SYMBOL res 1072 656 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R41
SYMATTR Value 100R
SYMBOL voltage 144 992 R180
WINDOW 0 -69 64 Left 2
WINDOW 3 24 4 Left 2
WINDOW 123 0 0 Left 0
WINDOW 39 76 -28 Left 2
SYMATTR InstName V3
SYMATTR Value SINE(0 -15 60)
SYMATTR SpiceLine Rser=0.1m
SYMBOL Opamps\\OP07 1728 768 R0
WINDOW 0 37 75 Left 2
SYMATTR InstName U11
SYMBOL cap 1760 640 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C22
SYMATTR Value .0068µ
SYMBOL res 1776 976 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R42
SYMATTR Value 56k
SYMBOL res 1600 800 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R43
SYMATTR Value 100k
SYMBOL res 1936 864 R0
WINDOW 3 36 76 Left 1
SYMATTR Value {25k*(1-RATE)}
SYMATTR InstName R44
SYMBOL res 1936 1024 R0
WINDOW 3 36 76 Left 1
SYMATTR Value {25k*(RATE)}
SYMATTR InstName R45
SYMBOL res 2112 976 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R46
SYMATTR Value 27k
SYMBOL res 1936 1152 R0
SYMATTR InstName R47
SYMATTR Value 82R
SYMBOL Opamps\\OP07 2224 944 R0
SYMATTR InstName U12
SYMBOL cap 2256 800 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C23
SYMATTR Value .47µ
SYMBOL res 1632 1152 R0
SYMATTR InstName R48
SYMATTR Value 47k
SYMBOL res 2144 1152 R0
SYMATTR InstName R49
SYMATTR Value 27k
SYMBOL res 2400 1056 R0
WINDOW 3 36 64 Left 1
SYMATTR Value {10k*(1-DEPTH)}
SYMATTR InstName R50
SYMBOL res 2400 1168 R0
WINDOW 3 40 58 Left 1
SYMATTR Value {10k*(DEPTH)}
SYMATTR InstName R51
SYMBOL res 2592 1152 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R52
SYMATTR Value 82k
SYMBOL res 2624 1056 R0
SYMATTR InstName R53
SYMATTR Value 47k
SYMBOL res 2624 1168 R0
SYMATTR InstName R54
SYMATTR Value 3.3k
SYMBOL res 2768 928 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 53 6 VTop 1
SYMATTR InstName R55
SYMATTR Value {10k*(SWEEPOFFSET)}
SYMBOL res 2624 928 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 46 102 VTop 1
SYMATTR InstName R56
SYMATTR Value {10k*(1-SWEEPOFFSET)}
SYMBOL res 2400 1296 R0
SYMATTR InstName R57
SYMATTR Value 560R
SYMBOL Opamps\\OP07 2896 1088 R0
SYMATTR InstName U13
SYMBOL npn 3088 1104 R0
SYMATTR InstName Q3
SYMATTR Value 2N3904
SYMBOL res 2960 1296 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R58
SYMATTR Value 220k
SYMBOL res 2960 1408 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R59
SYMATTR Value 10k
SYMBOL res 2960 1520 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R60
SYMATTR Value 68k
SYMBOL res 3136 1408 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R61
SYMATTR Value 220R
SYMBOL res 3248 1408 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 -54 92 VTop 1
SYMATTR InstName R62
SYMATTR Value {1k*(1-SWEEPRANGE)}
SYMBOL res 3360 1408 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 -51 14 VTop 1
SYMATTR InstName R63
SYMATTR Value {1k*(SWEEPRANGE)}
SYMBOL diode 2960 1440 R270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName D7
SYMATTR Value 1N4148
SYMBOL diode 3424 1216 R270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName D8
SYMATTR Value 1N4148
SYMBOL diode 3536 1216 R270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName D9
SYMATTR Value 1N4148
SYMBOL diode 3648 1216 R270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName D10
SYMATTR Value 1N4148
SYMBOL diode 2208 896 R0
SYMATTR InstName D11
SYMATTR Value 1N4148
SYMBOL diode 1712 736 R0
SYMATTR InstName D12
SYMATTR Value 1N4148
SYMBOL diode 3424 1088 R270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName D13
SYMATTR Value 1N4148
SYMBOL diode 3536 1088 R270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName D14
SYMATTR Value 1N4148
SYMBOL diode 3648 1088 R270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName D15
SYMATTR Value 1N4148
TEXT 1096 -344 Left 2 ;Transient analysis for oscillator frequency:\n.tran 1s startup
TEXT 1104 -528 Left 2 ;Stepping R:\n.step param R15 1 9k 1k
TEXT 88 1448 Left 2 !.tran 0.2s
TEXT 1096 -456 Left 2 ;Sweep multiple component values:\n.step param X list 1 2 3 4 5\n.param R15=table(X, 1, 0.1k, 2, 2.5k, 3, 5k, 4, 7.5k, 5, 9.9k) R14=table(X, 1, 9.9k, 2, 7.5k, 3, 5k, 4, 2.5k, 5, 0.1k)
TEXT 2512 872 Left 4 ;SWEEP OFFSET 10K
TEXT 3152 1480 Left 4 ;SWEEP RANGE 1K
TEXT 1984 824 Left 4 ;RATE \nA25K
TEXT 2488 1048 Left 4 ;DEPTH\nB10K
TEXT 1104 -744 Left 2 ;R1 value = {10k*(1-a)}\nR2 value = {10k*a}\nwith a spice directive like one of:\n.step param a list .1 .3 .6 .9\n.param a = .5
TEXT 2440 -488 Left 2 ;.step param POTROTRATE list 0.01 0.33 0.66 0.99
TEXT 2440 -456 Left 2 ;.param POTROTRATE = 0.5
TEXT 2440 -424 Left 2 ;.step param POTROTDEPTH list 0.01 0.33 0.66 0.99
TEXT 2440 -392 Left 2 ;.param POTROTDEPTH = 0.5
TEXT 2440 -360 Left 2 ;.step param POTROTOFFSET list 0.01 0.33 0.66 0.99
TEXT 2440 -328 Left 2 ;.param POTROTOFFSET = 0.5
TEXT 2440 -296 Left 2 ;.step param POTROTRANGE list 0.01 0.33 0.66 0.99
TEXT 2440 -264 Left 2 ;.param POTROTRANGE = 0.5
TEXT 88 1216 Left 2 !.param RATE=0.99
TEXT 88 1184 Left 2 !.param DEPTH=0.99
TEXT 88 1296 Left 2 !.step param SWEEPRANGE list 0.1 0.25 0.5 0.75 0.9
TEXT 88 1328 Left 2 !.step param SWEEPOFFSET list 0.1 0.25 0.5 0.75 0.9
TEXT 840 1216 Left 2 ;F=0.01, D=0.99, R=0.01, RANGE = 0.5, LDR = 50k -->\nSWEEP OFFSET =0.2 --> Clips op3out and Vdiodepos at top\nSWEEP OFFSET =0.35 --> Clips op3out and Vdiodepos at top\nSWEEP OFFSET =0.50 --> Clips op3out and Vdiodepos at top (barely)\nSWEEP OFFSET =0.65 --> \nSWEEP OFFSET =0.85 -->
TEXT 512 1416 Left 2 ;SWEEP OFFSET 0.45 appears good, 0.4 better at higher rate\nAt 0.5 spike disappears, but not current peak limits
